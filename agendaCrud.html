<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD Agenda</title>
</head>
<body>
    <script>
        let arryAgenda=[]

        function Menu() {
            return parseInt(prompt(`Cadastrando telefone e email ao seus contatos
            1- Cadastro novo contato
            2- Visualizar contatos
            3- Atualizar Contato
            4- Deletar contato
            5- Sair do menu
            `));
        }

        //ADICIONAR
       

        function AddPessoa() {
            const nomeContato= prompt("Digitar nome do novo contato");
            const numeroContato= parseInt(prompt("Digitar número do novo contato"));
            const emailContato= prompt("Digitar email do cantato");
            const dataAtual = new Date().toLocaleDateString();
            const dia = new Date()
            const horaAtual=dia.getHours();
            const minutos=dia.getMinutes();
            const segundos=dia.getSeconds();
            const formatada= horaAtual+":"+minutos+":"+segundos
            arryAgenda.push({nomeContato,numeroContato,emailContato,dataAtual,formatada});

            console.log(arryAgenda);
        }
        
        //LISTAR
            const ListPessoa = () => {
                let listPessoa = "";
            arryAgenda.forEach((dataUser) =>{
           listPessoa += `
           Nome: ${dataUser.nomeContato} 
           Telefone: ${dataUser.numeroContato} 
           Email: ${dataUser.emailContato} 
           Data: ${dataUser.dataAtual} 
           Hora: ${dataUser.formatada} `;});

        console.log(listPessoa);
        alert("***** Lista de contatos *****" + listPessoa);
        
            }
        // ATUALIZAR

        function UpdatePessoas() {
            let  atualizarDados =parseInt(prompt(`Qual das opçoes você deseja atualizar
            1- E-mail
            2- Telefone
            3- Voltar para o MENU anterior`));
        let atualizarContatos = true;
     while (atualizarContatos) {
        switch (atualizarDados) {
            case 1:
                const findEmail = prompt("Infome o email para atualizar")
                const emailEncontrado = arryAgenda.find((user) => user.emailContato === findEmail);
                if (!emailEncontrado) {
                    alert("Usuário não foi encontrado!");
                    return ;
                }
                   
                    const novoEmail = prompt("Informe o novo email: ");
                    const novoNomeUsuario = prompt("Informe o nome do usuário: ");
                    novoEmail ? (emailEncontrado.emailContato = novoEmail) : null;

                    if (novoNomeUsuario) {
                        emailEncontrado.nomeContato = novoNomeUsuario;
                        alert("Usuário foi atualizado com sucesso!");
                        return;
                    }

                     
                    
                    break;
            case 2:
                const findTelefone = parseInt(prompt("Infome telefone para atualizar"));
                const telefoneEncontrado = arryAgenda.find((user) => user.numeroContato === findTelefone);
            if (!telefoneEncontrado) {
                alert("Usuário não foi encontrado!");
                return;
            } 
                    const novoTelefone = prompt("Informe o novo Telefone: ");
                    const novoNomeUsuario1 = prompt("Informe o nome do usuário: ");
                    novoTelefone ? (telefoneEncontrado.numeroContato = novoTelefone) : null;
                    if (novoNomeUsuario1) {
                    telefoneEncontrado.nomeContato = novoNomeUsuario1;
                    alert("Usuário foi atualizado com sucesso!");
                    return;
            }
            case 3:
            atualizarContatos=false
                Menu()
                break;
                
            break;
            
                default:
                    alert("opção invalida");
                    break;
        }
    } 
 
}   
      //DELETAR

      function DeleteContato() {
        const emailDelete = prompt("Informe o email para deletar o contato!")
        const indiceDelete = arryAgenda.findIndex(email => email.emailContato === emailDelete)

        const confirmacao = window.confirm(`Você deseja mesmo excluir o contato ${emailDelete}`)
        

        if (confirmacao) {
            arryAgenda.splice(indiceDelete, 1)
        }

        alert("Usuário deletado com sucesso!")
      }
       
      let opcoes = true;
    while (opcoes) {
        
        switch (Menu()) {
            case 1:
                AddPessoa();
                break;
            case 2:
                ListPessoa();
                break;
            case 3:
                UpdatePessoas()
                break;
            case 4:
               DeleteContato()
                break;
            case 5:
               opcoes = false;
              alert("Saindo do programa, até mais!")
          break;
        default:
             alert("Opção inválida! Tente novamente")
          break;
        }
    }
    </script>
    
</body>
</html>
